# Qwen3 ASR è¯­éŸ³è¯†åˆ«æœåŠ¡éƒ¨ç½²æŒ‡å—

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªå…¼å®¹OpenAIæ¥å£çš„Qwen3è¯­éŸ³è¯†åˆ«(ASR)æœåŠ¡ï¼Œæ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼ã€‚æä¾›å®Œæ•´çš„è¯­éŸ³è½¬æ–‡å­—åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¤šè¯­è¨€æ”¯æŒã€æ™ºèƒ½æ ‡ç‚¹æ ¼å¼åŒ–ï¼Œä»¥åŠä¸OpenAI Whisper APIå®Œå…¨å…¼å®¹çš„æ¥å£ã€‚
 <img width="916" height="743" alt="æˆªå±2025-11-05 19 40 54" src="https://github.com/user-attachments/assets/315e29c0-22a8-4c82-8728-20f613b22d51" />

## ğŸš€ å¿«é€Ÿå¯¼èˆª

### é€‰æ‹©éƒ¨ç½²æ–¹å¼

| éƒ¨ç½²æ–¹å¼ | é€‚ç”¨åœºæ™¯ | å¿«é€Ÿå¼€å§‹ |
|----------|----------|----------|
| **[ğŸ”§ æœ¬åœ°å¼€å‘](#-æ–¹å¼ä¸€æœ¬åœ°å¼€å‘éƒ¨ç½²)** | å¼€å‘æµ‹è¯•ã€å¿«é€Ÿè°ƒè¯• | `npm install && npm run dev` |
| **[ğŸ³ Dockerå®¹å™¨](#-æ–¹å¼äºŒdockerå®¹å™¨éƒ¨ç½²)** | æœåŠ¡å™¨éƒ¨ç½²ã€ç¯å¢ƒä¸€è‡´ | `./deploy.sh start` |
| **[â˜ï¸ EdgeOne Pages](#-æ–¹å¼ä¸‰edgeone-pagesäº‘éƒ¨ç½²)** | ç”Ÿäº§ç¯å¢ƒã€å…è¿ç»´ | æ§åˆ¶å°ä¸Šä¼ ä»£ç  |

### æ¨èéƒ¨ç½²æµç¨‹

1. **å¼€å‘é˜¶æ®µ** â†’ [æœ¬åœ°å¼€å‘éƒ¨ç½²](#-æ–¹å¼ä¸€æœ¬åœ°å¼€å‘éƒ¨ç½²)
2. **æµ‹è¯•é˜¶æ®µ** â†’ [Dockerå®¹å™¨éƒ¨ç½²](#-æ–¹å¼äºŒdockerå®¹å™¨éƒ¨ç½²)  
3. **ç”Ÿäº§é˜¶æ®µ** â†’ [EdgeOne Pagesäº‘éƒ¨ç½²](#-æ–¹å¼ä¸‰edgeone-pagesäº‘éƒ¨ç½²)

---


## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

- âœ… **OpenAIå…¼å®¹æ¥å£**ï¼šå®Œå…¨å…¼å®¹OpenAIçš„è¯­éŸ³è½¬å½•APIæ ¼å¼
- âœ… **å¤šæœåŠ¡æ”¯æŒ**ï¼šDashScopeã€Z.aiä»£ç†ã€è‡ªå®šä¹‰ä»£ç†ä¸‰ç§æœåŠ¡
- âœ… **å¤šç§éƒ¨ç½²æ–¹å¼**ï¼šæœ¬åœ°å¼€å‘ã€Dockerå®¹å™¨ã€EdgeOne Pagesäº‘éƒ¨ç½²
- âœ… **æ ‡å‡†æ ¼å¼æ”¯æŒ**ï¼šæ”¯æŒæ ‡å‡†OpenAI multipart/form-dataæ ¼å¼
- âœ… **å¤šç§éŸ³é¢‘æ ¼å¼**ï¼šæ”¯æŒMP3ã€WAVã€M4Aã€FLACã€OGGç­‰
- âœ… **å¤šè¯­è¨€æ”¯æŒ**ï¼šä¸­æ–‡ã€è‹±æ–‡ã€æ—¥æ–‡ã€éŸ©æ–‡è‡ªåŠ¨æ£€æµ‹
- âœ… **ITNæ”¯æŒ**ï¼šé€†æ–‡æœ¬æ ‡å‡†åŒ–ï¼ˆæ™ºèƒ½æ ‡ç‚¹å’Œæ ¼å¼åŒ–ï¼‰
- âœ… **Webè°ƒè¯•ç•Œé¢**ï¼šç›´è§‚çš„éŸ³é¢‘ä¸Šä¼ å’Œè¯†åˆ«ç•Œé¢
- âœ… **å®Œæ•´CORSæ”¯æŒ**ï¼šæ”¯æŒè·¨åŸŸè¯·æ±‚
- âœ… **è¯¦ç»†è°ƒè¯•æ—¥å¿—**ï¼šæ–¹ä¾¿é—®é¢˜æ’æŸ¥å’Œæ€§èƒ½ç›‘æ§

## ğŸ“ é¡¹ç›®ç»“æ„

```
qwen3-asr-web/
â”œâ”€â”€ edge-functions/                  # EdgeOne Pageséƒ¨ç½²ä»£ç 
â”‚   â””â”€â”€ v1/
â”‚       â””â”€â”€ audio/
â”‚           â””â”€â”€ transcriptions.js   # ä¸»è¦åŠŸèƒ½ä»£ç 
â”œâ”€â”€ server.js                       # æœ¬åœ°å¼€å‘æœåŠ¡å™¨
â”œâ”€â”€ index.html                      # Webä¸»ç•Œé¢
â”œâ”€â”€ package.json                    # é¡¹ç›®ä¾èµ–é…ç½®
â”œâ”€â”€ package-lock.json               # ä¾èµ–é”å®šæ–‡ä»¶
â”œâ”€â”€ Dockerfile                      # Dockeré•œåƒæ„å»ºæ–‡ä»¶
â”œâ”€â”€ docker-compose.yml              # Docker Composeé…ç½®
â”œâ”€â”€ deploy.sh                       # Dockeréƒ¨ç½²è„šæœ¬
â”œâ”€â”€ .dockerignore                   # Dockerå¿½ç•¥æ–‡ä»¶é…ç½®
â”œâ”€â”€ .gitignore                      # Gitå¿½ç•¥é…ç½®
â””â”€â”€ éƒ¨ç½²æŒ‡å—.md                     # æœ¬æ–‡æ¡£
```

## ğŸš€ éƒ¨ç½²æ–¹å¼é€‰æ‹©

### éƒ¨ç½²é€‰é¡¹å¯¹æ¯”

| éƒ¨ç½²æ–¹å¼ | é€‚ç”¨åœºæ™¯ | ä¼˜åŠ¿ | åŠ£åŠ¿ | ç»´æŠ¤æˆæœ¬ |
|----------|----------|------|------|----------|
| **æœ¬åœ°å¼€å‘** | å¼€å‘æµ‹è¯•ã€åŸå‹éªŒè¯ | å¿«é€Ÿè°ƒè¯•ã€å®Œå…¨æ§åˆ¶ã€é›¶æˆæœ¬ | æ‰©å±•æ€§å·®ã€éœ€æ‰‹åŠ¨ç»´æŠ¤ | é«˜ |
| **Dockerå®¹å™¨** | è‡ªå»ºæœåŠ¡å™¨ã€äº‘ä¸»æœº | ç¯å¢ƒä¸€è‡´ã€æ˜“äºç®¡ç†ã€å¯ç§»æ¤ | éœ€è¦è¿ç»´çŸ¥è¯†ã€èµ„æºæˆæœ¬ | ä¸­ |
| **EdgeOne Pages** | ç”Ÿäº§ç¯å¢ƒã€é«˜å¯ç”¨è¦æ±‚ | å…è¿ç»´ã€è‡ªåŠ¨æ‰©ç¼©å®¹ã€å…¨çƒCDN | å‚å•†é”å®šã€å†·å¯åŠ¨å»¶è¿Ÿ | ä½ |

### æ¨èéƒ¨ç½²æµç¨‹

1. **å¼€å‘é˜¶æ®µ**ï¼šä½¿ç”¨æœ¬åœ°å¼€å‘ç¯å¢ƒè¿›è¡ŒåŠŸèƒ½æµ‹è¯•
2. **æµ‹è¯•é˜¶æ®µ**ï¼šä½¿ç”¨Dockerå®¹å™¨è¿›è¡Œé›†æˆæµ‹è¯•
3. **ç”Ÿäº§é˜¶æ®µ**ï¼šä½¿ç”¨EdgeOne Pagesè¿›è¡Œäº‘éƒ¨ç½²

---

## ğŸ”§ æ–¹å¼ä¸€ï¼šæœ¬åœ°å¼€å‘éƒ¨ç½²

### ç¯å¢ƒå‡†å¤‡

#### ç³»ç»Ÿè¦æ±‚
- **Node.js**ï¼šç‰ˆæœ¬ 16.0 æˆ–æ›´é«˜
- **npm**ï¼šç‰ˆæœ¬ 7.0 æˆ–æ›´é«˜
- **æ“ä½œç³»ç»Ÿ**ï¼šmacOSã€Windowsã€Linux

#### æ£€æŸ¥ç¯å¢ƒ
```bash
node --version
npm --version
```

### å®‰è£…å’Œå¯åŠ¨

#### 1. å®‰è£…ä¾èµ–
```bash
cd qwen3-asr-web
npm install
```

#### 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
npm run dev
```

#### 3. éªŒè¯æœåŠ¡
é¢„æœŸè¾“å‡ºï¼š
```
ğŸš€ Qwen3 è¯­éŸ³è¯†åˆ«æœåŠ¡å·²å¯åŠ¨!
ğŸ“ æœåŠ¡åœ°å€: http://localhost:8888
ğŸ™ï¸  APIç«¯ç‚¹: http://localhost:8888/v1/audio/transcriptions
ğŸŒ Webç•Œé¢: http://localhost:8888/index.html
â¤ï¸  å¥åº·æ£€æŸ¥: http://localhost:8888/healthz
```

### è®¿é—®åœ°å€

- **Webç•Œé¢**ï¼šhttp://localhost:8888
- **APIç«¯ç‚¹**ï¼šhttp://localhost:8888/v1/audio/transcriptions
- **å¥åº·æ£€æŸ¥**ï¼šhttp://localhost:8888/healthz
- **è°ƒè¯•æ¥å£**ï¼šhttp://localhost:8888/v1/audio/debug

### å¼€å‘è°ƒè¯•

#### æŸ¥çœ‹å®æ—¶æ—¥å¿—
æœåŠ¡å™¨ä¼šè¾“å‡ºè¯¦ç»†çš„æ—¥å¿—ä¿¡æ¯ï¼š
- è¯·æ±‚å¤„ç†è¿‡ç¨‹
- æ–‡ä»¶ä¸Šä¼ çŠ¶æ€
- APIè°ƒç”¨è¯¦æƒ…
- é”™è¯¯ä¿¡æ¯

#### ä»£ç çƒ­é‡è½½
ä¿®æ”¹ä»£ç åéœ€è¦æ‰‹åŠ¨é‡å¯ï¼š
```bash
# åœæ­¢æœåŠ¡
Ctrl+C

# é‡æ–°å¯åŠ¨
npm run dev
```

---

## ğŸ³ æ–¹å¼äºŒï¼šDockerå®¹å™¨éƒ¨ç½²

### ç¯å¢ƒå‡†å¤‡

ç¡®ä¿ç³»ç»Ÿå·²å®‰è£…ï¼š
- **Docker**ï¼šç‰ˆæœ¬ 20.10 æˆ–æ›´é«˜
- **Docker Compose**ï¼šç‰ˆæœ¬ 1.29 æˆ–æ›´é«˜

### å¿«é€Ÿå¯åŠ¨

#### æ–¹æ³•1ï¼šä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆæ¨èï¼‰
```bash
# å¯åŠ¨æœåŠ¡
./deploy.sh start

# æŸ¥çœ‹çŠ¶æ€
./deploy.sh status

# æŸ¥çœ‹æ—¥å¿—
./deploy.sh logs

# åœæ­¢æœåŠ¡
./deploy.sh stop

# é‡å¯æœåŠ¡
./deploy.sh restart
```

#### æ–¹æ³•2ï¼šä½¿ç”¨Docker Compose
```bash
# æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢æœåŠ¡
docker-compose down

# é‡å¯æœåŠ¡
docker-compose restart
```

#### æ–¹æ³•3ï¼šä½¿ç”¨Dockerå‘½ä»¤
```bash
# æ„å»ºé•œåƒ
docker build -t qwen3-asr:latest .

# è¿è¡Œå®¹å™¨
docker run -d \
  --name qwen3-asr \
  -p 8888:8888 \
  qwen3-asr:latest
```

### é…ç½®é€‰é¡¹

#### ç¯å¢ƒå˜é‡é…ç½®
åˆ›å»º `.env` æ–‡ä»¶ï¼š
```bash
# DashScope API Keyï¼ˆä¹Ÿå¯é€šè¿‡å‰ç«¯ä¼ å…¥ï¼‰
DASHSCOPE_API_KEY=your-dashscope-api-key

# Z.aiä»£ç†åœ°å€ï¼ˆå¯é€‰ï¼‰
UPSTREAM_ASR_ENDPOINT=https://your-zai-proxy.com

# å…¶ä»–é…ç½®
NODE_ENV=production
PORT=8888
```

#### ç«¯å£é…ç½®
ä¿®æ”¹ `docker-compose.yml` ä¸­çš„ç«¯å£æ˜ å°„ï¼š
```yaml
services:
  qwen3-asr:
    ports:
      - "8080:8888"  # å°†å®¹å™¨8888ç«¯å£æ˜ å°„åˆ°ä¸»æœº8080ç«¯å£
```

#### æ•°æ®æŒä¹…åŒ–
```yaml
volumes:
  - ./uploads:/app/uploads    # ä¸Šä¼ æ–‡ä»¶ç›®å½•
  - ./logs:/app/logs          # æ—¥å¿—ç›®å½•
```

### ç”Ÿäº§ç¯å¢ƒé…ç½®

#### åå‘ä»£ç†é…ç½®
ä½¿ç”¨Nginxä½œä¸ºåå‘ä»£ç†ï¼š
```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://localhost:8888;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶
        client_max_body_size 100M;
    }
}
```

#### SSLè¯ä¹¦é…ç½®
```bash
# å®‰è£…certbot
sudo apt-get install certbot python3-certbot-nginx

# è·å–SSLè¯ä¹¦
sudo certbot --nginx -d your-domain.com
```

### ç›‘æ§å’Œç»´æŠ¤

#### æŸ¥çœ‹èµ„æºä½¿ç”¨
```bash
# æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µ
docker stats qwen3-asr

# æŸ¥çœ‹ç£ç›˜ä½¿ç”¨
docker system df
```

#### å¤‡ä»½æ•°æ®
```bash
# å¤‡ä»½ä¸Šä¼ æ–‡ä»¶
tar -czf uploads-backup-$(date +%Y%m%d).tar.gz uploads/

# å¤‡ä»½é…ç½®
cp docker-compose.yml docker-compose.yml.backup
```

---

## â˜ï¸ æ–¹å¼ä¸‰ï¼šEdgeOne Pagesäº‘éƒ¨ç½²

### å‡†å¤‡å·¥ä½œ

1. **è…¾è®¯äº‘è´¦å·**ï¼šæ³¨å†Œè…¾è®¯äº‘å¹¶å¼€é€šEdgeOneæœåŠ¡
2. **APIå¯†é’¥**ï¼šå‡†å¤‡DashScope API Keyï¼ˆæ ¼å¼ï¼šsk-xxxï¼‰
3. **éŸ³é¢‘æ–‡ä»¶**ï¼šå‡†å¤‡æµ‹è¯•ç”¨çš„éŸ³é¢‘æ–‡ä»¶

### éƒ¨ç½²æ­¥éª¤

#### 1. ä¸Šä¼ ä»£ç 

**æ–¹æ³•1ï¼šæ§åˆ¶å°ä¸Šä¼ **
1. ç™»å½•è…¾è®¯äº‘EdgeOneæ§åˆ¶å°
2. é€‰æ‹©æˆ–åˆ›å»ºæ–°çš„Pagesåº”ç”¨
3. ç‚¹å‡»"ä¸Šä¼ æ–‡ä»¶"æˆ–"å¯¼å…¥é¡¹ç›®"
4. ä¸Šä¼  `edge-functions/` ç›®å½•
5. ç¡®è®¤æ–‡ä»¶è§£å‹åˆ°æ­£ç¡®çš„ç›®å½•ç»“æ„

**æ–¹æ³•2ï¼šCLIéƒ¨ç½²**ï¼ˆå¯é€‰ï¼‰
```bash
# å¦‚æœå®‰è£…äº†EdgeOne CLI
edgeone deploy --source edge-functions/
```

#### 2. é…ç½®è·¯ç”±

EdgeOne Pagesä¼šæ ¹æ®æ–‡ä»¶ç»“æ„è‡ªåŠ¨ç”Ÿæˆè·¯ç”±ï¼š
```
æ–‡ä»¶è·¯å¾„ï¼šedge-functions/v1/audio/transcriptions.js
è‡ªåŠ¨è·¯ç”±ï¼š/v1/audio/transcriptions
```

#### 3. è·å–è®¿é—®åœ°å€

éƒ¨ç½²å®Œæˆåï¼ŒEdgeOneä¼šæä¾›ä¸€ä¸ªåŸŸåï¼š
```
https://your-app-name.pages.tencentcloud.com
```

### è®¿é—®åœ°å€

- **ä¸»é¡µåœ°å€**ï¼š`https://your-domain.com/`
- **APIç«¯ç‚¹**ï¼š`https://your-domain.com/v1/audio/transcriptions`
- **å¥åº·æ£€æŸ¥**ï¼š`https://your-domain.com/healthz`
- **è°ƒè¯•æ¥å£**ï¼š`https://your-domain.com/v1/audio/debug`

### ç¯å¢ƒå˜é‡é…ç½®

åœ¨EdgeOne Pagesæ§åˆ¶å°é…ç½®ï¼š
- `UPSTREAM_ASR_ENDPOINT`ï¼šZ.aiä»£ç†æœåŠ¡çš„é»˜è®¤åœ°å€

---

## ğŸ“ APIæ–‡æ¡£

### åŸºç¡€ç«¯ç‚¹

| ç«¯ç‚¹ | æ–¹æ³• | åŠŸèƒ½ | ç¤ºä¾‹ |
|------|------|------|------|
| `/healthz` | GET | å¥åº·æ£€æŸ¥ | `curl http://localhost:8888/healthz` |
| `/v1/audio/debug` | GET | è°ƒè¯•ä¿¡æ¯ | `curl http://localhost:8888/v1/audio/debug` |
| `/v1/audio/transcriptions` | POST | è¯­éŸ³è¯†åˆ« | `curl -X POST ...` |

### è¯­éŸ³è¯†åˆ«API

#### è¯·æ±‚æ ¼å¼
- **æ–¹æ³•**ï¼šPOST
- **URL**ï¼š`/v1/audio/transcriptions`
- **Content-Type**ï¼šmultipart/form-data
- **è®¤è¯**ï¼šAuthorization Bearer æˆ– X-API-Key

#### è¯·æ±‚å‚æ•°

| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| file | File | æ˜¯ | - | éŸ³é¢‘æ–‡ä»¶ |
| language | String | å¦ | auto | è¯­è¨€ä»£ç  |
| model | String | å¦ | qwen3-asr-flash | æ¨¡å‹åç§° |
| prompt | String | å¦ | - | æç¤ºè¯ |
| upstream_url | String | å¦ | - | Z.aiæˆ–è‡ªå®šä¹‰ä»£ç†åœ°å€ |
| custom_key | String | å¦ | - | è‡ªå®šä¹‰ä»£ç†API Key |
| custom_header | String | å¦ | - | è®¤è¯æ–¹å¼ |

#### æ”¯æŒçš„è¯­è¨€
- `zh`ï¼šä¸­æ–‡
- `en`ï¼šè‹±æ–‡
- `ja`ï¼šæ—¥æ–‡
- `ko`ï¼šéŸ©æ–‡
- `auto`ï¼šè‡ªåŠ¨æ£€æµ‹ï¼ˆé»˜è®¤ï¼‰

#### æ”¯æŒçš„æ¨¡å‹
- `qwen3-asr-flash`ï¼šå¿«é€Ÿè¯†åˆ«ï¼ˆé»˜è®¤ï¼‰
- `qwen3-asr`ï¼šæ ‡å‡†è¯†åˆ«
- `qwen3-asr-flash:itn`ï¼šå¿«é€Ÿ+ITN
- `qwen3-asr:itn`ï¼šæ ‡å‡†+ITN
- `paraformer-realtime-8k-v1`ï¼šé˜¿é‡Œäº‘Paraformeræ¨¡å‹

#### å“åº”æ ¼å¼
```json
{
  "text": "è¯†åˆ«å‡ºçš„æ–‡æœ¬å†…å®¹"
}
```

#### é”™è¯¯å“åº”
```json
{
  "error": "é”™è¯¯æè¿°",
  "detail": "è¯¦ç»†ä¿¡æ¯"
}
```

### ä½¿ç”¨ç¤ºä¾‹

#### curlç¤ºä¾‹
```bash
curl -X POST http://localhost:8888/v1/audio/transcriptions \
  -H "Authorization: Bearer sk-your-dashscope-key" \
  -F "file=@audio.mp3" \
  -F "language=zh" \
  -F "model=qwen3-asr-flash" \
  -F "prompt=è¿™æ˜¯æŠ€æœ¯è®¨è®ºçš„å½•éŸ³"
```

#### JavaScriptç¤ºä¾‹
```javascript
const formData = new FormData();
formData.append('file', audioFile);
formData.append('language', 'zh');
formData.append('model', 'qwen3-asr-flash');

const response = await fetch('http://localhost:8888/v1/audio/transcriptions', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer sk-your-dashscope-key'
  },
  body: formData
});

const result = await response.json();
console.log('è¯†åˆ«ç»“æœ:', result.text);
```

#### Pythonç¤ºä¾‹
```python
import requests

url = "http://localhost:8888/v1/audio/transcriptions"
headers = {"Authorization": "Bearer sk-your-dashscope-key"}

with open("audio.mp3", "rb") as f:
    files = {"file": f}
    data = {
        "language": "zh",
        "model": "qwen3-asr-flash"
    }
    response = requests.post(url, headers=headers, files=files, data=data)
    result = response.json()
    print("è¯†åˆ«ç»“æœ:", result["text"])
```

---

## ğŸ§ª åŠŸèƒ½æµ‹è¯•

### å¥åº·æ£€æŸ¥
```bash
# æœ¬åœ°ç¯å¢ƒ
curl http://localhost:8888/healthz

# Dockerç¯å¢ƒ
curl http://localhost:8888/healthz

# EdgeOne Pagesç¯å¢ƒ
curl https://your-domain.com/healthz
```

### è°ƒè¯•ä¿¡æ¯
```bash
curl http://localhost:8888/v1/audio/debug
```

### è¯­éŸ³è¯†åˆ«æµ‹è¯•

#### å‡†å¤‡æµ‹è¯•éŸ³é¢‘
- **æ”¯æŒæ ¼å¼**ï¼šMP3ã€WAVã€M4Aã€FLACã€OGG
- **å»ºè®®å¤§å°**ï¼š1-50MB
- **æ¨èæ—¶é•¿**ï¼š10ç§’-10åˆ†é’Ÿ

#### Webç•Œé¢æµ‹è¯•
1. æ‰“å¼€Webç•Œé¢ï¼ˆæ ¹æ®éƒ¨ç½²æ–¹å¼é€‰æ‹©å¯¹åº”åœ°å€ï¼‰
2. é€‰æ‹©æœåŠ¡ç±»å‹ï¼š
   - **DashScope**ï¼šè¾“å…¥API Keyï¼ˆæ ¼å¼ï¼šsk-xxxï¼‰
   - **Z.aiä»£ç†**ï¼šè¾“å…¥ä»£ç†åœ°å€
   - **è‡ªå®šä¹‰ä»£ç†**ï¼šè¾“å…¥ä»£ç†åœ°å€ã€API Keyå’Œè®¤è¯æ–¹å¼
3. ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶
4. è®¾ç½®å‚æ•°ï¼ˆè¯­è¨€ã€æ¨¡å‹ã€æç¤ºè¯ç­‰ï¼‰
5. ç‚¹å‡»"å¼€å§‹è¯­éŸ³è¯†åˆ«"

---

## ğŸ› æ•…éšœæ’é™¤

### é€šç”¨é—®é¢˜

#### 1. ç«¯å£è¢«å ç”¨
**é”™è¯¯ä¿¡æ¯**ï¼š`Error: listen EADDRINUSE :::8888`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -i :8888

# æ€æ­»è¿›ç¨‹
kill -9 è¿›ç¨‹ID

# æˆ–è€…ä½¿ç”¨å…¶ä»–ç«¯å£
PORT=8080 npm run dev
```

#### 2. API Keyæ— æ•ˆ
**é”™è¯¯ä¿¡æ¯**ï¼š`{"error":"getPolicy failed","detail":"..."}`

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥API Keyæ ¼å¼æ˜¯å¦æ­£ç¡®ï¼ˆsk-å¼€å¤´ï¼‰
- ç¡®è®¤DashScopeè´¦æˆ·ä½™é¢å……è¶³
- éªŒè¯API Keyæƒé™è®¾ç½®

#### 3. éŸ³é¢‘æ–‡ä»¶æ— æ³•è¯†åˆ«
**é”™è¯¯ä¿¡æ¯**ï¼š`failed to parse multipart form`

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®è®¤éŸ³é¢‘æ–‡ä»¶æ ¼å¼å—æ”¯æŒ
- æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æŸå
- å°è¯•ä½¿ç”¨è¾ƒå°çš„éŸ³é¢‘æ–‡ä»¶

#### 4. è¯†åˆ«ç»“æœä¸ºç©º
**åŸå› åˆ†æ**ï¼š
- éŸ³é¢‘è´¨é‡è¿‡ä½
- è¯­è¨€è®¾ç½®ä¸åŒ¹é…
- èƒŒæ™¯å™ªéŸ³è¿‡å¤š

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨æ¸…æ™°çš„éŸ³é¢‘æ–‡ä»¶
- è®¾ç½®æ­£ç¡®çš„è¯­è¨€å‚æ•°
- æ·»åŠ ç›¸å…³æç¤ºè¯

### æœ¬åœ°å¼€å‘é—®é¢˜

#### 1. Node.jsç‰ˆæœ¬è¿‡ä½
**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# ä½¿ç”¨nvmå®‰è£…æ–°ç‰ˆæœ¬
nvm install 18
nvm use 18
```

#### 2. ä¾èµ–å®‰è£…å¤±è´¥
**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ¸…ç†ç¼“å­˜é‡æ–°å®‰è£…
npm cache clean --force
rm -rf node_modules package-lock.json
npm install
```

### Dockeré—®é¢˜

#### 1. å®¹å™¨å¯åŠ¨å¤±è´¥
```bash
# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker-compose logs qwen3-asr

# æ£€æŸ¥é•œåƒæ„å»º
docker build -t qwen3-asr:debug .
docker run -it --rm qwen3-asr:debug sh
```

#### 2. å†…å­˜ä¸è¶³
```bash
# å¢åŠ Dockerå†…å­˜é™åˆ¶
# åœ¨docker-compose.ymlä¸­æ·»åŠ ï¼š
deploy:
  resources:
    limits:
      memory: 2G
    reservations:
      memory: 1G
```

#### 3. ç½‘ç»œè¿æ¥é—®é¢˜
```bash
# é‡å¯Dockerç½‘ç»œ
docker network prune
docker-compose down
docker-compose up -d
```

### EdgeOne Pagesé—®é¢˜

#### 1. 502 Bad Gateway
**åŸå› **ï¼šDashScope API Keyæ— æ•ˆæˆ–ç½‘ç»œé—®é¢˜

**è§£å†³**ï¼š
- æ£€æŸ¥API Keyæ ¼å¼æ˜¯å¦æ­£ç¡®ï¼ˆsk-å¼€å¤´ï¼‰
- ç¡®è®¤DashScopeè´¦æˆ·ä½™é¢å……è¶³
- æŸ¥çœ‹EdgeOneå‡½æ•°æ—¥å¿—

#### 2. CORSé”™è¯¯
**åŸå› **ï¼šè·¨åŸŸè¯·æ±‚è¢«é˜»æ­¢

**è§£å†³**ï¼š
- æ£€æŸ¥è¯·æ±‚å¤´è®¾ç½®
- ç¡®è®¤EdgeOne Pagesçš„CORSé…ç½®

#### 3. å†·å¯åŠ¨å»¶è¿Ÿ
**ç°è±¡**ï¼šé¦–æ¬¡è¯·æ±‚å“åº”è¾ƒæ…¢

**è§£å†³**ï¼š
- è¿™æ˜¯ServerlessæœåŠ¡çš„æ­£å¸¸ç°è±¡
- å¯ä»¥é€šè¿‡å®šæœŸè¯·æ±‚ä¿æŒçƒ­åº¦
- è€ƒè™‘ä½¿ç”¨å…¶ä»–éƒ¨ç½²æ–¹å¼å¯¹å»¶è¿Ÿæ•æ„Ÿçš„åº”ç”¨

### è°ƒè¯•æ–¹æ³•

#### 1. æŸ¥çœ‹æ—¥å¿—
- **æœ¬åœ°ç¯å¢ƒ**ï¼šæ§åˆ¶å°ç›´æ¥è¾“å‡º
- **Dockerç¯å¢ƒ**ï¼š`docker-compose logs -f`
- **EdgeOne Pages**ï¼šæ§åˆ¶å°å‡½æ•°æ—¥å¿—

#### 2. ä½¿ç”¨è°ƒè¯•ç«¯ç‚¹
è®¿é—® `/v1/audio/debug` è·å–æœåŠ¡çŠ¶æ€ä¿¡æ¯

#### 3. ç½‘ç»œæµ‹è¯•
```bash
# æµ‹è¯•è¿é€šæ€§
curl -v http://localhost:8888/healthz

# æµ‹è¯•APIæ ¼å¼
curl -X POST http://localhost:8888/v1/audio/transcriptions \
  -H "Content-Type: multipart/form-data" \
  -F "file=@test.mp3"
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### æœ¬åœ°å¼€å‘ä¼˜åŒ–
- **æ–‡ä»¶ç¼“å­˜**ï¼šé‡å¤ä½¿ç”¨ç›¸åŒçš„æµ‹è¯•æ–‡ä»¶
- **å¹¶å‘æ§åˆ¶**ï¼šé¿å…åŒæ—¶å‘é€è¿‡å¤šè¯·æ±‚
- **å†…å­˜ç›‘æ§**ï¼šå…³æ³¨æœåŠ¡å™¨å†…å­˜ä½¿ç”¨æƒ…å†µ

### Dockerä¼˜åŒ–
```yaml
# è°ƒæ•´å®¹å™¨èµ„æº
deploy:
  resources:
    limits:
      cpus: '1.0'
      memory: 2G
    reservations:
      cpus: '0.5'
      memory: 1G

# å¯ç”¨æ„å»ºç¼“å­˜
build:
  cache_from:
    - qwen3-asr:latest
```

### è¯†åˆ«æ•ˆæœä¼˜åŒ–
- **éŸ³é¢‘é¢„å¤„ç†**ï¼šç¡®ä¿éŸ³é¢‘è´¨é‡
- **å‚æ•°è°ƒä¼˜**ï¼šé€‰æ‹©åˆé€‚çš„æ¨¡å‹å’Œè¯­è¨€
- **æç¤ºè¯ä¼˜åŒ–**ï¼šæä¾›ç›¸å…³çš„èƒŒæ™¯ä¿¡æ¯

### ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–
- **è´Ÿè½½å‡è¡¡**ï¼šä½¿ç”¨å¤šä¸ªå®ä¾‹åˆ†æ•£è¯·æ±‚
- **CDNåŠ é€Ÿ**ï¼šç¼“å­˜é™æ€èµ„æº
- **ç›‘æ§å‘Šè­¦**ï¼šè®¾ç½®æ€§èƒ½ç›‘æ§é˜ˆå€¼

---

## ğŸ”’ å®‰å…¨å»ºè®®

### API Keyç®¡ç†
1. **ç¯å¢ƒå˜é‡**ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨æ•æ„Ÿä¿¡æ¯
2. **å¯†é’¥è½®æ¢**ï¼šå®šæœŸæ›´æ¢API Key
3. **æƒé™æœ€å°åŒ–**ï¼šåªæˆäºˆå¿…è¦çš„æƒé™

### ç½‘ç»œå®‰å…¨
1. **HTTPS**ï¼šç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨HTTPS
2. **CORSé…ç½®**ï¼šåˆç†é…ç½®è·¨åŸŸè®¿é—®ç­–ç•¥
3. **è®¿é—®æ§åˆ¶**ï¼šè®¾ç½®IPç™½åå•æˆ–è®¤è¯æœºåˆ¶

### å®¹å™¨å®‰å…¨
1. **érootç”¨æˆ·**ï¼šä½¿ç”¨éç‰¹æƒç”¨æˆ·è¿è¡Œå®¹å™¨
2. **é•œåƒå®‰å…¨**ï¼šå®šæœŸæ›´æ–°åŸºç¡€é•œåƒ
3. **ç½‘ç»œéš”ç¦»**ï¼šé™åˆ¶å®¹å™¨ç½‘ç»œè®¿é—®

### æ•°æ®å®‰å…¨
1. **æ•°æ®åŠ å¯†**ï¼šæ•æ„Ÿæ•°æ®ä¼ è¾“åŠ å¯†
2. **æ—¥å¿—è„±æ•**ï¼šé¿å…åœ¨æ—¥å¿—ä¸­è®°å½•æ•æ„Ÿä¿¡æ¯
3. **å®šæœŸå¤‡ä»½**ï¼šå¤‡ä»½é‡è¦é…ç½®å’Œæ•°æ®

---

## ğŸ“ˆ ç›‘æ§å’Œç»´æŠ¤

### æ€§èƒ½ç›‘æ§æŒ‡æ ‡
- **å“åº”æ—¶é—´**ï¼šAPIè°ƒç”¨å»¶è¿Ÿ
- **æˆåŠŸç‡**ï¼šè¯†åˆ«æˆåŠŸçš„æ¯”ä¾‹
- **é”™è¯¯ç‡**ï¼šå¤±è´¥è¯·æ±‚çš„æ¯”ä¾‹
- **å¹¶å‘æ•°**ï¼šåŒæ—¶å¤„ç†çš„è¯·æ±‚æ•°

### æ—¥å¿—ç®¡ç†
```bash
# æ—¥å¿—è½®è½¬é…ç½®ç¤ºä¾‹
/path/to/qwen3-asr/logs/*.log {
    daily
    missingok
    rotate 30
    compress
    delaycompress
    notifempty
    create 644 root root
    postrotate
        docker-compose restart qwen3-asr
    endscript
}
```

### å¤‡ä»½ç­–ç•¥
1. **é…ç½®å¤‡ä»½**ï¼šå®šæœŸå¤‡ä»½é…ç½®æ–‡ä»¶
2. **æ•°æ®å¤‡ä»½**ï¼šå¤‡ä»½ä¸Šä¼ çš„éŸ³é¢‘æ–‡ä»¶
3. **æ—¥å¿—å¤‡ä»½**ï¼šä¿ç•™é‡è¦æ—¥å¿—ç”¨äºåˆ†æ

### æ›´æ–°å‡çº§
```bash
# Dockerç¯å¢ƒæ›´æ–°
git pull
docker-compose down
docker-compose build --no-cache
docker-compose up -d

# æœ¬åœ°ç¯å¢ƒæ›´æ–°
git pull
npm install
npm run dev
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### é—®é¢˜æ’æŸ¥æ­¥éª¤
1. **æ£€æŸ¥æœåŠ¡çŠ¶æ€**ï¼šç¡®è®¤æœåŠ¡æ­£å¸¸è¿è¡Œ
2. **éªŒè¯API Key**ï¼šç¡®ä¿è®¤è¯ä¿¡æ¯æœ‰æ•ˆ
3. **æµ‹è¯•éŸ³é¢‘æ ¼å¼**ï¼šä½¿ç”¨æ”¯æŒçš„éŸ³é¢‘æ–‡ä»¶
4. **æŸ¥çœ‹è¯¦ç»†æ—¥å¿—**ï¼šåˆ†æé”™è¯¯ä¿¡æ¯
5. **æ£€æŸ¥ç½‘ç»œè¿æ¥**ï¼šç¡®è®¤ç½‘ç»œé€šç•…

### è°ƒè¯•èµ„æº
- **æµè§ˆå™¨æ§åˆ¶å°**ï¼šæŸ¥çœ‹å‰ç«¯é”™è¯¯
- **æœåŠ¡å™¨æ—¥å¿—**ï¼šæŸ¥çœ‹åç«¯å¤„ç†ä¿¡æ¯
- **ç½‘ç»œé¢æ¿**ï¼šæ£€æŸ¥HTTPè¯·æ±‚è¯¦æƒ…

### å®˜æ–¹æ–‡æ¡£
- **DashScopeæ–‡æ¡£**ï¼šhttps://help.aliyun.com/zh/dashscope/
- **è…¾è®¯äº‘EdgeOne**ï¼šhttps://cloud.tencent.com/document/product/1552
- **OpenAI APIæ–‡æ¡£**ï¼šhttps://platform.openai.com/docs/api-reference/audio

### ç¤¾åŒºæ”¯æŒ
- **GitHub Issues**ï¼šæäº¤é—®é¢˜å’Œå»ºè®®
- **æŠ€æœ¯è®ºå›**ï¼šå‚ä¸ç¤¾åŒºè®¨è®º
- **QQç¾¤/å¾®ä¿¡ç¾¤**ï¼šè·å–å®æ—¶å¸®åŠ©

---

## ğŸ‰ éƒ¨ç½²å®Œæˆ

æ­å–œï¼æ‚¨å·²ç»æˆåŠŸéƒ¨ç½²äº†Qwen3 ASRè¯­éŸ³è¯†åˆ«æœåŠ¡ã€‚ç°åœ¨æ‚¨å¯ä»¥ï¼š

### âœ… å·²å®ŒæˆåŠŸèƒ½
- [x] è¯­éŸ³è½¬æ–‡å­—è¯†åˆ«
- [x] å¤šè¯­è¨€æ”¯æŒï¼ˆä¸­è‹±æ—¥éŸ©ï¼‰
- [x] æ™ºèƒ½æ ‡ç‚¹æ ¼å¼åŒ–
- [x] OpenAIå…¼å®¹æ¥å£
- [x] Webè°ƒè¯•ç•Œé¢
- [x] å¤šç§éƒ¨ç½²æ–¹å¼æ”¯æŒ

### ğŸš€ å¼€å§‹ä½¿ç”¨
1. **æµ‹è¯•API**ï¼šä½¿ç”¨æä¾›çš„ç¤ºä¾‹ä»£ç æµ‹è¯•è¯­éŸ³è¯†åˆ«
2. **é›†æˆåº”ç”¨**ï¼šå°†APIé›†æˆåˆ°æ‚¨çš„åº”ç”¨ä¸­
3. **æ€§èƒ½è°ƒä¼˜**ï¼šæ ¹æ®å®é™…éœ€æ±‚ä¼˜åŒ–å‚æ•°
4. **ç›‘æ§è¿ç»´**ï¼šè®¾ç½®ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶

### ğŸ’¡ æœ€ä½³å®è·µ
- é€‰æ‹©åˆé€‚çš„éƒ¨ç½²æ–¹å¼
- å®šæœŸç›‘æ§æœåŠ¡çŠ¶æ€
- ä¼˜åŒ–éŸ³é¢‘è´¨é‡ä»¥æé«˜è¯†åˆ«å‡†ç¡®ç‡
- åˆç†è®¾ç½®è¶…æ—¶å’Œé‡è¯•æœºåˆ¶

ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒæ•…éšœæ’é™¤éƒ¨åˆ†æˆ–è”ç³»æŠ€æœ¯æ”¯æŒã€‚
